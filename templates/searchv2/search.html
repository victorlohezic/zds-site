{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load i18n %}



{% block title %}
    {% trans "Recherche" %}
{% endblock %}



{% block body_class %}flexpage searchpage{% endblock %}



{% block content_out %}
    <section class="flexpage-header">
        <div class="flexpage-wrapper">
            <section class="search-box">
                {% crispy form %}
            </section>
            <ul class="search-filters">
                {% for radio in form.models %}
                    <li>
                        {{ radio.tag }}
                        <label for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                    </li>
                {% endfor %}
            </ul>
            <ul class="search-filters">
                {% for radio in form.content_types %}
                    <li>
                        {{ radio.tag }}
                        <label for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                    </li>
                {% endfor %}
            </ul>
            <ul class="search-filters">
                {% for radio in form.validated_content %}
                    <li>
                        {{ radio.tag }}
                        <label for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </section>

    <div class="flexpage-wrapper">
        {% if query %}
            {% include "misc/paginator.html" with position="top" %}

            {% if object_list %}
                <div class="topic-list navigable-list search-results">
                    {% for result in object_list %}
                    <article class="content-item topic-item" data-search-engine-score="{{ result.text_match }}" data-search-boost="{{ result.document.score }}" data-search-final-score="{{ result.document.final_score }}">
                        {%  if result.collection  == 'chapter' %}
                            {% include "searchv2/includes/chapter.part.html" with search_result=result.document %}
                        {% elif result.collection == 'publishedcontent' %}
                            {% include "searchv2/includes/publishedcontent.part.html" with search_result=result.document %}
                        {% elif result.collection == 'topic' %}
                            {% include "searchv2/includes/topic.part.html" with search_result=result.document %}
                        {% elif result.collection == 'post' %}
                            {% include "searchv2/includes/post.part.html" with search_result=result.document %}
                        {% endif %}
                    </article>
                    {% endfor %}
                </div>
            {% else %}
                <p>
                    {% trans "Aucun résultat trouvé." %}
                </p>
            {% endif %}


            {% include "misc/paginator.html" with position="bottom" %}
        {% endif %}
    </div>
{% endblock %}
